;
; below parameters to be setted
;
getsyringeparms 1
ask $2$,Choose Syringe,Enter the number of the syringe to use for titration,1,1,$numsyringes$
eval $2$,int($2$)
getsyringeparms $2$
ask $1$,Max ml,Enter the total volume to use for titration,10,0.1,$syringevol$
eval $maxs$,$syringevol$*10
ask $step$,Max additions,Enter number of additions to make,1,1,$maxs$
eval $step$,int($step$)
ask $pause$,Pause,Enter pause in seconds between additions,1,0,200
eval $pause$,int($pause$)
ask $init$,Init syringe?,Enter 1 to init the syringe. In the case remove the outlet tube from the titration beaker and replace after the procedure ended.,1,0,1
eval $cond$,$init$==0
if $cond$ no_init
buffer
macro "prime syringe X"$2$
macro "syrY_X_ml"15,1
print
label no_init
ask $dummy$,Ready to start,Press OK to start. Before be sure that motors are not running and outlet tube of syringe $2$ is correctly inserted into titration beker,1,0,1
; procedure starts here
buffer
eval $pause$,$pause$*1000; transforms the value in milliseconds
getsyringeparms $2$
eval $valve1$,($2$-1)*2
eval $valve2$,$valve1$+1
eval $ml$,$syringemax$-$1$*($syringemax$/$syringevol$)
macro "valve_X_exit_2"$valve1$
send G1 $axisname$$ml$,0; take $ml$ milliliters
send M400,0; wait for task completion
macro "valve_X_exit_1"$valve1$
macro "valve_X_exit_2"$valve2$
for $cyc$ $step$
eval $vol$,($cyc$-1)*($1$/$step$); calculate the volume in the syringe for each addition
eval $ml$,$syringemax$-$vol$*($syringemax$/$syringevol$)
send G1 $axisname$$ml$,0; drop
send M400,0
send G4 P$pause$,0; wait (number in milliseconds)
next
macro "valve_X_close"$valve1$
macro "valve_X_close"$valve2$
log executing titration with syringe $2$, using $1$ mL in total and making $step$ additions with a pause of $pause$ ms
print













